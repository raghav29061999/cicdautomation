from __future__ import annotations
import streamlit as st
import streamlit.components.v1 as components


def render_flip_cards() -> None:
    css = """
    <style>
      .cards { display:flex; gap:16px; flex-wrap:wrap; }
      .flip-card { background: transparent; width: 260px; height: 150px; perspective: 1000px; }
      .flip-card-inner {
        position: relative; width: 100%; height: 100%;
        transition: transform 0.6s; transform-style: preserve-3d;
      }
      .flip-card:hover .flip-card-inner { transform: rotateY(180deg); }
      .flip-card-front, .flip-card-back {
        position: absolute; width: 100%; height: 100%;
        -webkit-backface-visibility: hidden; backface-visibility: hidden;
        border-radius: 14px; padding: 16px;
        box-shadow: 0 8px 18px rgba(0,0,0,0.25);
        display:flex; flex-direction:column; justify-content:center;
      }
      .flip-card-front {
        background: linear-gradient(135deg, #0f172a, #1e3a8a);
        color: white;
      }
      .flip-card-back {
        background: linear-gradient(135deg, #111827, #334155);
        color: white;
        transform: rotateY(180deg);
      }
      .icon { font-size: 30px; margin-bottom: 8px; }
      .title { font-size: 16px; font-weight: 700; margin: 0; }
      .desc { font-size: 13px; opacity: 0.9; margin-top: 8px; }
    </style>
    """

    html = css + """
    <div class="cards">
      <div class="flip-card">
        <div class="flip-card-inner">
          <div class="flip-card-front">
            <div class="icon">ðŸ§ </div>
            <p class="title">Agentic Test Design</p>
            <p class="desc">From story â†’ CIR â†’ test cases</p>
          </div>
          <div class="flip-card-back">
            <p class="title">Deterministic</p>
            <p class="desc">Strict contracts, validation, traceability.</p>
          </div>
        </div>
      </div>

      <div class="flip-card">
        <div class="flip-card-inner">
          <div class="flip-card-front">
            <div class="icon">ðŸ§ª</div>
            <p class="title">Test Data Intelligence</p>
            <p class="desc">Generate or ingest user data</p>
          </div>
          <div class="flip-card-back">
            <p class="title">Flexible</p>
            <p class="desc">Use JSON/XLSX input or synthesize small datasets.</p>
          </div>
        </div>
      </div>

      <div class="flip-card">
        <div class="flip-card-inner">
          <div class="flip-card-front">
            <div class="icon">ðŸ“„</div>
            <p class="title">Gherkin Specs</p>
            <p class="desc">Business-readable scenarios</p>
          </div>
          <div class="flip-card-back">
            <p class="title">Executable</p>
            <p class="desc">One scenario per file. Links to tests & ACs via comments.</p>
          </div>
        </div>
      </div>
    </div>
    """

    # Height a bit bigger than cards so it doesn't clip
    components.html(html, height=190, scrolling=False)


-----------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------

-----------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
import streamlit as st
from src.ui.components.flip_cards import render_flip_cards


def render_about() -> None:
    st.title("A new era of AI-led software quality")
    st.write(
        "This tool turns user stories into test cases, test data, and Gherkin specifications â€” "
        "deterministically, with strong validation and traceability."
    )
    st.divider()
    render_flip_cards()
    st.divider()
    st.subheader("What this tool does")
    st.markdown(
        "- **Input:** one user story (.txt)\n"
        "- **Output:** phase-1 artifacts + TestCases.json + TestData.json (optional) + Gherkin .feature files\n"
        "- **Guarantees:** schema validation, AC traceability, deterministic IDs"
    )


-------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------------


import streamlit as st
from src.ui.components.chat import init_chat, render_chat, add_user, add_assistant


def render_studio(run_pipeline_callback) -> None:
    st.title("Studio")
    st.caption("Upload a user story and generate outputs.")

    init_chat()
    render_chat()

    st.divider()

    story_file = st.file_uploader("Upload User Story (.txt)", type=["txt"])
    data_file = st.file_uploader("Optional: Upload TestData (.json or .xlsx)", type=["json", "xlsx"])

    col1, col2 = st.columns([1, 1])
    with col1:
        run = st.button("Run", type="primary", use_container_width=True)
    with col2:
        clear = st.button("Clear Chat", use_container_width=True)

    if clear:
        st.session_state.chat = [{"role": "assistant", "content": "Welcome. Upload a story and click Run to generate artifacts."}]
        st.rerun()

    if run:
        if not story_file:
            add_assistant("Please upload a user story file first.")
            st.rerun()

        story_text = story_file.read().decode("utf-8", errors="ignore")
        add_user(f"Uploaded: {story_file.name}")

        # Run your pipeline (LangGraph)
        result = run_pipeline_callback(story_text=story_text, data_file=data_file)

        add_assistant(f"Run completed. run_id={result.get('run_id')}")

        st.success("Generated outputs successfully.")
        st.json(result)
        st.rerun()
-

-------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------


